<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="BlogNews"><meta property="og:type" content="article"><meta name=robots content="index,follow,noarchive"><meta property="og:image" content="//img/home-bg-jeep.jpg"><meta property="twitter:image" content="//img/home-bg-jeep.jpg"><meta name=title content="RabbitMQ failed to start, TCP connection succeeded but Erlang distribution failed"><meta property="og:title" content="RabbitMQ failed to start, TCP connection succeeded but Erlang distribution failed"><meta property="twitter:title" content="RabbitMQ failed to start, TCP connection succeeded but Erlang distribution failed"><meta name=description content="I'm a new one just start to learn and install RabbitMQ on Windows System. I install Erlang VM and RabbitMQ in custom folder, not default folder (Both of them). Then I have restarted my computer. By the wayMy Computer name is &amp;quot;NULL&amp;quot;"><meta property="og:description" content="I'm a new one just start to learn and install RabbitMQ on Windows System. I install Erlang VM and RabbitMQ in custom folder, not default folder (Both of them). Then I have restarted my computer. By the wayMy Computer name is &amp;quot;NULL&amp;quot;"><meta property="twitter:description" content="I'm a new one just start to learn and install RabbitMQ on Windows System. I install Erlang VM and RabbitMQ in custom folder, not default folder (Both of them). Then I have restarted my computer. By the wayMy Computer name is &amp;quot;NULL&amp;quot;"><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=./img/favicon.ico><title>RabbitMQ failed to start, TCP connection succeeded but Erlang distribution failed |</title><link rel=canonical href=./rabbitmq-failed-to-start-tcp-connection-succeeded-but-erlang-distribution-faile.html><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/bootstrap.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/zanshang.css><link href=https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@5.15.1/css/all.css rel=stylesheet type=text/css><script src=https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/bootstrap.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/hux-blog.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=./>BlogNews</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=./categories/blog>blog</a></li><li><a href=./sitemap.xml>Sitemap</a></li><li><a href=./index.xml>RSS</a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/img/home-bg-jeep.jpg)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags></div><h1>RabbitMQ failed to start, TCP connection succeeded but Erlang distribution failed</h1><h2 class=subheading></h2><span class=meta>Posted by
Jenniffer Sheldon
on
Thursday, March 7, 2024</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><p>I'm a new one just start to learn and install RabbitMQ on Windows System.</p><p>I install Erlang VM and RabbitMQ in custom folder, not default folder (Both of them).</p><p>Then I have restarted my computer.</p><p><strong>By the way，My Computer name is "NULL"</strong></p><p>I cd to the <strong>RabbitMQ/sbin</strong> folder and use command：</p><p><code>rabbitmqctl status</code></p><p>But the return message is：</p><p>Status of node rabbit@NULL ...</p><p>Error: unable to perform an operation on node 'rabbit@NULL'. Please see diagnostics information and suggestions below.</p><p>Most common reasons for this are:</p><ul><li>Target node is unreachable (e.g. due to hostname resolution, TCP connection or firewall issues)</li><li>CLI tool fails to authenticate with the server (e.g. due to CLI tool's Erlang cookie not matching that of the server)</li><li>Target node is not running</li></ul><p>In addition to the diagnostics info below:</p><ul><li>See the CLI, clustering and networking guides on <a href=# rel=noreferrer>http://rabbitmq.com/documentation.html</a> to learn more</li><li>Consult server logs on node rabbit@NULL</li></ul><p>DIAGNOSTICS</p><p>attempted to contact: [rabbit@NULL]</p><p>rabbit@NULL:</p><ul><li>connected to epmd (port 4369) on NULL</li><li>epmd reports node 'rabbit' uses port 25672 for inter-node and CLI tool traffic</li><li><p>TCP connection succeeded but Erlang distribution failed</p></li><li><p>Authentication failed (rejected by the remote node), please check the Erlang cookie</p></li></ul><p>Current node details:</p><ul><li>node name: rabbitmqcli70@NULL</li><li>effective user's home directory: C:\Users\Jerry Song</li><li>Erlang cookie hash: 51gvGHZpn0gIK86cfiS7vp==</li></ul><p>I have try to RESTART RabbitMQ, What I get is：</p><p>ERROR: node with name "rabbit" already running on "NULL"</p><p><strong>By the way，My Computer name is "NULL"</strong> <strong>And I have enable all ports in firewall.</strong></p><span class=d-none itemprop=commentCount>2</span><h2 class=mb0 data-answercount=11>11 Answers</h2><p><a href=# rel=noreferrer>https://groups.google.com/forum/#!topic/rabbitmq-users/a6sqrAUX_Fg</a> describes the problem where there is a cookie mismatch on a fresh installation of Rabbit MQ. The easy solution on windows is to synchronize the cookies</p><p>Also described here: <a href=# rel=noreferrer>http://www.rabbitmq.com/clustering.html#erlang-cookie</a></p><p>Ensure cookies are synchronized across 1, 2 and Optionally 3 below</p><li><p><code>%HOMEDRIVE%%HOMEPATH%\.erlang.cookie</code> (usually <code>C:\Users\%USERNAME%\.erlang.cookie</code> for user %USERNAME%) if both the HOMEDRIVE and HOMEPATH environment variables are set</p></li><li><p><code>%USERPROFILE%\.erlang.cookie</code> (usually <code>C:\Users\%USERNAME%\.erlang.cookie</code>) if <strong>HOMEDRIVE</strong> and <strong>HOMEPATH</strong> are not both set</p></li><li>For the RabbitMQ Windows service - <code>%USERPROFILE%\.erlang.cookie</code> (usually <code>C:\WINDOWS\system32\config\systemprofile</code>)</li><p>The cookie file used by the Windows service account and the user running CLI tools must be synchronized by copying the one from <code>C:\WINDOWS\system32\config\systemprofile</code> folder.</p><span class=d-none itemprop=commentCount>4</span><p>If you are using dedicated drive folder locations for your development tools/software in Windows10(Not the windows default location), one way you can synchronize the erlang cookie as described by <a href=# rel=noreferrer>https://www.rabbitmq.com/cli.html</a> is by copying the cookie as explained below.</p><p>Please note in my case HOMEDRIVE and HOMEPATH environment variables both are <strong>not</strong> set.</p><p>After copying the <strong>"C:\Windows\system32\config\systemprofile\.erlang.cookie"</strong> to <strong>"C:\Users\%USERNAME%\.erlang.cookie"</strong> ,</p><p>the error "tcp connection succeeded but Erlang distribution failed" is resolved.</p><p>Now I am able to use "rabbitmqctl.bat status" command successfully. Hence there is no mandatory need to install in default location to resolve this error as synchronizing cookie will resolve that error.</p><span class=d-none itemprop=commentCount>3</span><p>In my case similar issue (Authentication failed because of Erlang cookies mismatch) solved by copying <code>.erlang.cookie</code> file from <code>Windows</code> system dir - <code>C:\Windows\system32\config\systemprofile\.erlang.cookie</code> to <code>%HOMEDRIVE%%HOMEPATH%\.erlang.cookie</code> (where <code>%HOMEDRIVE%</code> was set to <code>H:</code> and <code>%HOMEPATH%</code> to <code>\</code> respectively)</p><p><strong>Quick setup TODO for Windows, Erlang OTP 24 and RabbitMQ 3.8.19</strong>:</p><li>Download & Install Erlang [<strong>OTP 24</strong>] (needs Admin rights) from: <a href=# rel=noreferrer>https://www.erlang.org/downloads</a></li><li>set <code>ERLANG_HOME</code> (should point to install dir)</li><li>Download & Install recent [<strong>3.8.19</strong>] RabbitMQ (needs Admin rights) from: <a href=# rel=noreferrer>https://github.com/rabbitmq/rabbitmq-server/releases/</a></li><li>Follow: <a href=# rel=noreferrer>https://www.rabbitmq.com/install-windows.html</a> and/or <a href=# rel=noreferrer>https://www.rabbitmq.com/install-windows-manual.html</a></li><li>set <code>RABBITMQ_SERVER</code> (should point to install dir)</li><li>update <code>%PATH%</code> by adding: <code>;%RABBITMQ_SERVER%\sbin</code></li><li>Fix Erlang-cookie issue from above, follow: <a href=# rel=noreferrer>https://www.rabbitmq.com/cli.html#erlang-cookie</a></li><li>Enable Web UI by running command: <code>%RABBITMQ_SERVER%/sbin/rabbitmq-plugins.bat enable rabbitmq_management</code></li><li>From item #8 (above) got error because of missing file: <code>%USERPROFILEDIR%/AppData/Roaming/RabbitMQ/enabled_plugins</code> -> had to create it and run <code>%RABBITMQ_SERVER%/sbin/rabbitmq-plugins.bat enable rabbitmq_management</code> again!</li><li>Run/restart on the way might be required</li><li>Finally, login to: http://localhost:15672/ (guest:guest) <a href=# rel=noreferrer><img src=https://cdn.statically.io/img/i.stack.imgur.com/WFnEc.png alt="RabbitMQ web UI" style=margin:auto;display:block;text-align:center;max-width:100%;height:auto></a></li><p>, or check by cURL: <code>curl -i -u guest:guest http://localhost:15672/api/vhosts</code> should receive response like:</p><pre class="snippet-code-html lang-html prettyprint-override"><code> HTTP/1.1 200 OK cache-control: no-cache content-length: 186 content-security-policy: script-src 'self' 'unsafe-eval' 'unsafe-inline'; object-src 'self' content-type: application/json date: Tue, 13 Jul 2021 11:21:12 GMT server: Cowboy vary: accept, accept-encoding, origin [{"cluster_state":{"rabbit@hostname":"running"},"description":"Default virtual host","metadata":{"description":"Default virtual host","tags":[]},"name":"/","tags":[],"tracing":false}]</code></pre><p>P.S. Some useful RabbitMQ CLI commands (copy-paste):</p><ul><li><code>%RABBITMQ_SERVER%/sbin/rabbitmqctl start_app</code></li><li><code>%RABBITMQ_SERVER%/sbin/rabbitmqctl stop_app</code></li><li><code>%RABBITMQ_SERVER%/sbin/rabbitmqctl status</code></li></ul><p>P.P.S. <strong>UPDATE</strong>: great article for this subject: <a href=# rel=noreferrer>https://www.journaldev.com/11655/spring-rabbitmq</a></p><span class=d-none itemprop=commentCount></span><p>How I resolved mine</p><p>It's mostly caused by cookie mismatch on a fresh installation of Rabbit MQ</p><p>follow this 2 steps</p><pre><code>1. copy the .erlang.cookie file from C:\Windows\System32\config\systemprofile paste it into C:\Users\["your user nameusername"] folder 2. run rabbitmq-service.bat stop and rabbitmq-service.bat start </code></pre><p>Done it should work now when you run 'rabbitmqctl start_app' good luck.</p><p>note if you have more than one user put it in the correct user folder</p><span class=d-none itemprop=commentCount>1</span><p>I have <strong>reinstalled the RabbitMQ</strong> in my computer by <strong>using default setup folder</strong></p><p>Then checked with the command :</p><p><code>rabbitmqctl status</code></p><p>It works now, not the problem of Erlang VM .(Means Er can install at another folder)</p><p>It will cause some problem (like this one) that I couldn't find out now if we don't use the RabbitMQ <strong>default setup require folder</strong> (C:\Program Files\RabbitMQ Server)</p><p>If anyone finds it out, I hope you can tell me why and how to fix.</p><span class=d-none itemprop=commentCount>2</span><p>In Centos.</p><li><p>add ip nodename pair to /etc/hosts on each node.</p></li><li><p>restart rabbitmq-server service on each slave node.</p></li><p>works for me.</p><span class=d-none itemprop=commentCount>2</span><p>i got error like this, i just stop my rabbitMQ with close port 25672 here syntax for linux:<br><code>kill -9 $(lsof -t -i:25672)</code></p><p>Error Images:</p><p><a href=# rel="nofollow noreferrer"><img src=https://cdn.statically.io/img/i.stack.imgur.com/lzs94.jpg alt="enter image description here" style=margin:auto;display:block;text-align:center;max-width:100%;height:auto></a></p><span class=d-none itemprop=commentCount>3</span><p>Just adding my experience if it helps others down the line.</p><p>I wrote a Powershell .ps1 script to install and configure RabbitMQ which would be used as one of the stept to provision a server with Packer.</p><p>I wrote the code on a fresh AWS W2016 Server build. It worked fine when run on the box (as administrator, from an admin PS console) but when the same code was moved over to the Packer build server, it would fall over when doing the rabbitmqctl.bat configuration steps via packer, despite both using (as far as I can tell) Administrator to run the scripts.</p><p>So this worked on the coding box:</p><pre><code>$pathvargs = {cmd.exe /c "rabbitmqctl.bat" add_user Username Password} Invoke-Command -ScriptBlock $pathvargs $pathvargs = {cmd.exe /c "rabbitmqctl.bat" set_user_tags User administrator} Invoke-Command -ScriptBlock $pathvargs $pathvargs = {cmd.exe /c "rabbitmqctl.bat" set_permissions -p "/" User "^User-.*" ".*" ".*"} Invoke-Command -ScriptBlock $pathvargs Write-Host "Did RabbitMQ" </code></pre><p>But I had to prelude this with...</p><pre><code>copy "C:\Windows\system32\config\systemprofile\.erlang.cookie" "C:\Program Files\RabbitMQ Server\rabbitmq_server-3.7.17\sbin\.erlang.cookie" copy "C:\Windows\system32\config\systemprofile\.erlang.cookie" $env:userprofile\.erlang.cookie -force </code></pre><p>... On the Packer box.</p><p>I am guessing there is some context issue going on but I'm using</p><pre><code>"winrm_username": "Administrator", </code></pre><p>in the Packer builders block, so I thought this would suffice.</p><p>TL;DR - Use the Cookie even though it works without it in some instances.</p><span class=d-none itemprop=commentCount></span><p>I have encountered the same error after installing Erlang VM and RabbitMQ using the default installation folders in Windows 10. Managed to start the management and access it via HTTP, but status failed with this error.</p><p>The cookie was fine in all folders (<code>%HOMEDRIVE%%HOMEPATH%</code>, <code>%USERPROFILE%</code>, <code>C:\WINDOWS\system32\config\systemprofile</code>).</p><p>I had to perform a restart the Windows to make it work. After restart it set up something to run at startup + asked permission to make an exception in the firewall.</p><span class=d-none itemprop=commentCount></span><p>In my case, the file was at <code>c:\\Windows\.erlang.cookie</code>, just copied it to C:\Users{USERNAME} and all works, thanks to everyone for the hits</p><span class=d-none itemprop=commentCount></span><p>Another thing to check after making sure the cookie file is in all the locations.. is to realize that you installed 32 bit Erlang.. not 64.. Happened to me. Removed 32 bit Erlang and Installed 64 and rabbitmqctl status returns expected results.</p><span class=d-none itemprop=commentCount>1</span><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmirpJawrLvVnqmfpJ%2Bse6S7zGiorp2jqbawutJoa3BwZ2mGdoSOq5ibmpmpurJ5xZqgpZ2UYsGwedKtmKusXamwsXnCqKWnnZOptrC6jKysnJuVmrGmsIybrK1llae5orrGZpuiq6SntqPB06Kmp2WWlratsQ%3D%3D</p><hr><ul class=pager><li class=previous><a href=./who-is-jeffrey-dean-morgan-ex-wife-anya-longwell.html data-toggle=tooltip data-placement=top title="Who is Jeffrey Dean Morgan Ex Wife Anya Longwell?">&larr;
Previous Post</a></li><li class=next><a href=./lisa-nichols.html data-toggle=tooltip data-placement=top title="Lisa Nichols">Next
Post &rarr;</a></li></ul></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=./tags/>FEATURED TAGS</a></h5><div class=tags></div></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"></ul><p class="copyright text-muted">Copyright &copy; BlogNews 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(i,t){var n=document,s="script",e=n.createElement(s),o=n.getElementsByTagName(s)[0];e.src=i,t&&e.addEventListener("load",function(e){t(null,e)},!1),o.parentNode.insertBefore(e,o)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,r=$(_containerSelector),a=r.find("h1,h2,h3,h4,h5,h6");return $(e).html(''),a.each(function(){n=$(this).prop("tagName").toLowerCase(),i="#"+$(this).prop("id"),s=$(this).text(),t=$('<a href="'+i+'" rel="nofollow">'+s+"</a>"),o=$('<li class="'+n+'_nav"></li>').append(t),$(e).append(o)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/banner.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>